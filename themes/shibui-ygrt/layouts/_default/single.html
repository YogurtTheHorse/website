{{ define "main" }}
  <h1>{{ .Title }}</h1>

  {{ if .Params.Logo }}
  {{- $u := urls.Parse .Params.Logo -}}
  {{- $src := $u.String -}}
  {{- if not $u.IsAbs -}}
    {{- $path := strings.TrimPrefix "./" $u.Path -}}
    {{- with (resources.Get $path) -}}
      {{- $src = .RelPermalink -}}
      {{- with $u.RawQuery -}}
        {{- $src = printf "%s?%s" $src . -}}
      {{- end -}}
      {{- with $u.Fragment -}}
        {{- $src = printf "%s#%s" $src . -}}
      {{- end -}}
    {{- end -}}
  {{- end -}}
  <img src="{{ $src }}" class="float-right width-60" />
  {{ end }}

  {{ partial "terms.html" (dict "taxonomy" "tags" "page" .) }}
  {{ partial "date.html" .Date}}

  {{/* Table of Contents */}}
  {{ $hasToC := .Params.toc | default true }}
  {{ $headers := findRE "<h[2-6]" .Content }}
  {{ if and $hasToC (ge (len $headers) 1) }}
    <nav class="toc">
      <div class="toc-content">
        {{ .TableOfContents }}
      </div>
    </nav>
  {{ end }}

  {{ .Content }}

  {{ if not .IsHome }}
    <div class="terminal-nav">
      <div class="back-nav">
        <a href="../" class="back-link">../</a>
      </div>
    </div>
  {{ end }}
{{ end }}
